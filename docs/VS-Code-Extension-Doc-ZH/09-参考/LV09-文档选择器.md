---
title: LV09-æ–‡æ¡£é€‰æ‹©å™¨
date: 2025-08-02 07:43:48
icon: famicons:logo-markdown
index: true
tags:
categories:
---

<!-- more -->

# [æ–‡æ¡£é€‰æ‹©å™¨](https://vscode.js.cn/api/references/document-selector)

æ‰©å±•å¯ä»¥æ ¹æ®è¯­è¨€ã€æ–‡ä»¶ç±»å‹å’Œä½ç½®ï¼Œé€šè¿‡æ–‡æ¡£é€‰æ‹©å™¨æ¥ç­›é€‰å…¶åŠŸèƒ½ã€‚æœ¬ä¸»é¢˜è®¨è®ºæ–‡æ¡£é€‰æ‹©å™¨ã€æ–‡æ¡£æ–¹æ¡ˆï¼Œä»¥åŠæ‰©å±•ä½œè€…åº”è¯¥æ³¨æ„çš„äº‹é¡¹ã€‚

## [ä¸åœ¨ç£ç›˜ä¸Šçš„æ–‡æœ¬æ–‡æ¡£](https://vscode.js.cn/api/references/document-selector#text-documents-not-on-disk)

å¹¶éæ‰€æœ‰æ–‡æœ¬æ–‡æ¡£éƒ½å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œä¾‹å¦‚æ–°åˆ›å»ºçš„æ–‡æ¡£ã€‚é™¤éå¦æœ‰è¯´æ˜ï¼Œæ–‡æ¡£é€‰æ‹©å™¨é€‚ç”¨äº**æ‰€æœ‰**æ–‡æ¡£ç±»å‹ã€‚ä½¿ç”¨ [DocumentFilter](https://vscode.js.cn/api/references/vscode-api#DocumentFilter) çš„ `scheme` å±æ€§å¯ä»¥ç¼©å°åˆ°ç‰¹å®šçš„æ–¹æ¡ˆï¼Œä¾‹å¦‚å¯¹äºå­˜å‚¨åœ¨ç£ç›˜ä¸Šçš„ TypeScript æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ `{ scheme: 'file', language: 'typescript' }`ã€‚

## [æ–‡æ¡£é€‰æ‹©å™¨](https://vscode.js.cn/api/references/document-selector#document-selectors)

Visual Studio Code æ‰©å±• API é€šè¿‡ [DocumentSelector](https://vscode.js.cn/api/references/vscode-api#DocumentSelector) ç±»å‹å°†ç‰¹å®šè¯­è¨€çš„åŠŸèƒ½ï¼ˆå¦‚ IntelliSenseï¼‰ä¸æ–‡æ¡£é€‰æ‹©å™¨ç»“åˆèµ·æ¥ã€‚å®ƒä»¬æ˜¯ä¸€ç§å°†åŠŸèƒ½é™å®šåˆ°ç‰¹å®šè¯­è¨€çš„ç®€ä¾¿æœºåˆ¶ã€‚

ä»¥ä¸‹ä»£ç ç‰‡æ®µä¸º TypeScript æ–‡ä»¶æ³¨å†Œäº†ä¸€ä¸ª [HoverProvider](https://vscode.js.cn/api/references/vscode-api#HoverProvider)ï¼Œæ–‡æ¡£é€‰æ‹©å™¨æ˜¯ `typescript` è¯­è¨€æ ‡è¯†ç¬¦å­—ç¬¦ä¸²ã€‚

```typescript
vscode.languages.registerHoverProvider('typescript', {
  provideHover(doc: vscode.TextDocument) {
    return new vscode.Hover('For *all* TypeScript documents.');
  }
});
```

æ–‡æ¡£é€‰æ‹©å™¨å¯ä»¥ä¸ä»…ä»…æ˜¯ä¸€ä¸ªè¯­è¨€æ ‡è¯†ç¬¦ï¼Œæ›´å¤æ‚çš„é€‰æ‹©å™¨å¯ä»¥ä½¿ç”¨ [DocumentFilter](https://vscode.js.cn/api/references/vscode-api#DocumentFilter) æ¥æ ¹æ® `scheme` å’Œé€šè¿‡ `pattern` è·¯å¾„å…¨å±€æ¨¡å¼æ¥è¿‡æ»¤æ–‡ä»¶ä½ç½®ã€‚

```typescript
vscode.languages.registerHoverProvider(
  { pattern: '**/test/**' },
  {
    provideHover(doc: vscode.TextDocument) {
      return new vscode.Hover('For documents inside `test`-folders only');
    }
  }
);
```

ä¸‹ä¸€ä¸ªä»£ç ç‰‡æ®µä½¿ç”¨ `scheme` è¿‡æ»¤å™¨å¹¶å°†å…¶ä¸è¯­è¨€æ ‡è¯†ç¬¦ç»“åˆã€‚`untitled` æ–¹æ¡ˆç”¨äºå°šæœªä¿å­˜åˆ°ç£ç›˜çš„æ–°æ–‡ä»¶ã€‚

```typescript
vscode.languages.registerHoverProvider(
  { scheme: 'untitled', language: 'typescript' },
  {
    provideHover(doc: vscode.TextDocument) {
      return new vscode.Hover('For new, unsaved TypeScript documents only');
    }
  }
);
```

## [æ–‡æ¡£æ–¹æ¡ˆ](https://vscode.js.cn/api/references/document-selector#document-scheme)

æ–‡æ¡£çš„ `scheme` é€šå¸¸è¢«å¿½è§†ï¼Œä½†å®ƒæ˜¯ä¸€ä¸ªé‡è¦çš„ä¿¡æ¯ã€‚å¤§å¤šæ•°æ–‡æ¡£éƒ½ä¿å­˜åœ¨ç£ç›˜ä¸Šï¼Œæ‰©å±•ä½œè€…é€šå¸¸å‡å®šä»–ä»¬æ­£åœ¨å¤„ç†ç£ç›˜ä¸Šçš„æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç®€å•çš„ `typescript` é€‰æ‹©å™¨ï¼Œå…¶å‡è®¾æ˜¯**ç£ç›˜ä¸Šçš„ TypeScript æ–‡ä»¶**ã€‚ç„¶è€Œï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œè¿™ç§å‡è®¾è¿‡äºå®½æ¾ï¼Œåº”è¯¥ä½¿ç”¨æ›´æ˜ç¡®çš„é€‰æ‹©å™¨ï¼Œä¾‹å¦‚ `{ scheme: 'file', language: 'typescript' }`ã€‚

å½“åŠŸèƒ½ä¾èµ–äºä»ç£ç›˜è¯»å–/å†™å…¥æ–‡ä»¶æ—¶ï¼Œè¿™ä¸€ç‚¹çš„é‡è¦æ€§å°±ä½“ç°å‡ºæ¥äº†ã€‚è¯·çœ‹ä¸‹é¢çš„ä»£ç ç‰‡æ®µï¼š

```typescript
// ğŸ‘ too lax
vscode.languages.registerHoverProvider('typescript', {
  provideHover(doc: vscode.TextDocument) {
    const { size } = fs.statSync(doc.uri.fsPath); // âš ï¸ what about 'untitled:/Untitled1.ts' or others?
    return new vscode.Hover(`Size in bytes is ${size}`);
  }
});
```

ä¸Šé¢çš„æ‚¬åœæä¾›ç¨‹åºæƒ³æ˜¾ç¤ºç£ç›˜ä¸Šæ–‡æ¡£çš„å¤§å°ï¼Œä½†å®ƒæ²¡æœ‰æ£€æŸ¥æ–‡æ¡£æ˜¯å¦å®é™…å­˜å‚¨åœ¨ç£ç›˜ä¸Šã€‚ä¾‹å¦‚ï¼Œå®ƒå¯èƒ½åˆšåˆšåˆ›å»ºä¸”å°šæœªä¿å­˜ã€‚æ­£ç¡®çš„åšæ³•æ˜¯å‘Šè¯‰ VS Codeï¼Œè¯¥æä¾›ç¨‹åºåªèƒ½å¤„ç†ç£ç›˜ä¸Šçš„æ–‡ä»¶ã€‚

```typescript
// ğŸ‘ only works with files on disk
vscode.languages.registerHoverProvider(
  { scheme: 'file', language: 'typescript' },
  {
    provideHover(doc: vscode.TextDocument) {
      const { size } = fs.statSync(doc.uri.fsPath);
      return new vscode.Hover(`Size in bytes is ${size}`);
    }
  }
);
```

## [æ€»ç»“](https://vscode.js.cn/api/references/document-selector#summary)

æ–‡æ¡£é€šå¸¸å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œä½†å¹¶éæ€»æ˜¯å¦‚æ­¤ï¼šæœ‰æœªå‘½åæ–‡æ¡£ã€Git ä½¿ç”¨çš„ç¼“å­˜æ–‡æ¡£ã€æ¥è‡ªè¿œç¨‹æºï¼ˆå¦‚ FTPï¼‰çš„æ–‡æ¡£ç­‰ç­‰ã€‚å¦‚æœæ‚¨çš„åŠŸèƒ½ä¾èµ–äºç£ç›˜è®¿é—®ï¼Œè¯·ç¡®ä¿ä½¿ç”¨å¸¦æœ‰ `file` æ–¹æ¡ˆçš„æ–‡æ¡£é€‰æ‹©å™¨ã€‚

## [åç»­æ­¥éª¤](https://vscode.js.cn/api/references/document-selector#next-steps)

è¦äº†è§£æœ‰å…³ VS Code å¯æ‰©å±•æ€§æ¨¡å‹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å°è¯•ä»¥ä¸‹ä¸»é¢˜

- [æ‰©å±•æ¸…å•æ–‡ä»¶](https://vscode.js.cn/api/references/extension-manifest) - VS Code package.json æ‰©å±•æ¸…å•æ–‡ä»¶å‚è€ƒ
- [è´¡çŒ®ç‚¹](https://vscode.js.cn/api/references/contribution-points) - VS Code è´¡çŒ®ç‚¹å‚è€ƒ
